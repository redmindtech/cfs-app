(self.webpackChunkcfs=self.webpackChunkcfs||[]).push([[592],{5203:(e,t,n)=>{"use strict";n.d(t,{a:()=>h});var a=n(3679),o=n(3109),r=n(7716),s=n(2238),i=n(8583),c=n(1095),l=n(8295),d=n(7441),u=n(2458);function m(e,t){1&e&&r._UZ(0,"div",7)}function p(e,t){if(1&e&&(r.TgZ(0,"div"),r._uU(1),r.qZA()),2&e){const e=r.oxw();r.xp6(1),r.Oqu(e.scannedValue)}}function g(e,t){if(1&e&&(r.TgZ(0,"mat-option",8),r._uU(1),r.qZA()),2&e){const e=t.$implicit;r.Q6J("value",e.id),r.xp6(1),r.hij(" ",e.label," ")}}let h=(()=>{class e{constructor(e){this.dialogRef=e,this.cameraFC=new a.NI,this.cameras=[],this.selectCameraLabel="Loading Camera...",this.scannedValue=""}ngOnInit(){o.t2.getCameras().then(e=>{e&&e.length&&(this.selectCameraLabel="Select Camera",this.cameras=e,this.cameraFC.setValue(this.getLastCamera(),{emitEvent:!1}),this.scan(this.cameraFC.value))}).catch(e=>{}),this.cameraFC.valueChanges.subscribe(e=>{localStorage.setItem("lastUsedCameraId",e),this.scan(e),this.scannedValue=""})}getLastCamera(){let e;try{e=localStorage.getItem("lastUsedCameraId")}catch(t){}return e=e||this.cameras[0].id,e}scan(e){var t,n,a;let r=(null===(t=document.getElementById("scanner"))||void 0===t?void 0:t.offsetWidth)?(null===(n=document.getElementById("scanner"))||void 0===n?void 0:n.offsetWidth)-100:innerWidth;(null===(a=document.getElementById("scanner"))||void 0===a?void 0:a.offsetHeight)?document.getElementById("scanner"):innerHeight,this.html5QrCode=new o.t2("scanner",!0),this.html5QrCode.start(e,{fps:10,qrbox:{width:r,height:r}},(e,t)=>{this.scannedValue=e,this.dialogRef.close(this.scannedValue)},e=>{console.log(e)}).catch(e=>{})}ngOnDestroy(){this.html5QrCode.stop().then(e=>{}).catch(e=>{})}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(s.so))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-barcode-scanner-popup"]],decls:10,vars:5,consts:[["id","scanner","class","w-100",4,"ngIf"],[1,"d-flex","mt-3"],["mat-raised-button","","mat-dialog-close","",1,"ml-auto"],[4,"ngIf"],[1,"w-100","mt-3"],[3,"formControl"],[3,"value",4,"ngFor","ngForOf"],["id","scanner",1,"w-100"],[3,"value"]],template:function(e,t){1&e&&(r.YNc(0,m,1,0,"div",0),r.TgZ(1,"div",1),r.TgZ(2,"button",2),r._uU(3,"Close"),r.qZA(),r.qZA(),r.YNc(4,p,2,1,"div",3),r.TgZ(5,"mat-form-field",4),r.TgZ(6,"mat-label"),r._uU(7),r.qZA(),r.TgZ(8,"mat-select",5),r.YNc(9,g,2,2,"mat-option",6),r.qZA(),r.qZA()),2&e&&(r.Q6J("ngIf",!t.scannedValue),r.xp6(4),r.Q6J("ngIf",t.scannedValue),r.xp6(3),r.Oqu(t.selectCameraLabel),r.xp6(1),r.Q6J("formControl",t.cameraFC),r.xp6(1),r.Q6J("ngForOf",t.cameras))},directives:[i.O5,c.lW,s.ZT,l.KE,l.hX,d.gD,a.JJ,a.oH,i.sg,u.ey],styles:[""]}),e})()},2873:(e,t,n)=>{"use strict";n.d(t,{n:()=>l});var a=n(1841),o=n(5917),r=n(1295),s=n(2340),i=n(8002),c=n(7716);let l=(()=>{class e{constructor(e){this.http=e,this.devanningDataKey="devanningData"}setLocalStorage(e){window.localStorage.setItem(this.devanningDataKey,JSON.stringify(e))}getLocalStorage(){try{return JSON.parse(window.localStorage.getItem(this.devanningDataKey))}catch(e){return[]}}getContainerDetails(e){const t={headers:new a.WM({"Content-Type":"application/x-www-form-urlencoded"})},n=new URLSearchParams;let o=window.localStorage.getItem("Token");return this.http.post(`${s.N.apiUrl}/getcontainer_list?user_token=${o}&username=${e}&saas_id=LIVEFSL`,n.toString(),t).pipe((0,i.U)(e=>{try{return e}catch(t){return e}}))}saveSeal(e,t){let n=t.segment_code,o=t.job_no,r=t.container_no,c=e.actualSeal,l=e.unloadingDate;const d={headers:new a.WM({"Content-Type":"application/x-www-form-urlencoded"})},u=new URLSearchParams;let m=window.localStorage.getItem("Token");return this.http.post(`${s.N.apiUrl}/save_seal?user_token=${m}&segment_code=${n}&saas_id=LIVEFSL&job_no=${o}&container_no=${r}&house_no=&actual_seal=${c}&unloading_date=${l}`,u.toString(),d).pipe((0,i.U)(e=>{try{return e}catch(t){return e}}))}getHblDetails(e){let t=e.segment_code,n=e.job_no,o=e.container_no;const r={headers:new a.WM({"Content-Type":"application/x-www-form-urlencoded"})},c=new URLSearchParams;let l=window.localStorage.getItem("Token");return this.http.post(`${s.N.apiUrl}/gethbl_list?user_token=${l}&segment_code=${t}&saas_id=LIVEFSL&job_no=${n}&container_no=${o}`,c.toString(),r).pipe((0,i.U)(e=>{try{return e}catch(t){return e}}))}getSaveItem(e,t){let n=t.segment_code,o=e.jobNo,r=e.containerNo,c=e.hblNumber,l=e.packageType,d=e.receivedPiece,u=e.damageCondition,m=e.damageType,p=e.damageNotes,g=e.weight,h=e.cbm,_=e.subJobNo,w=e.cfsNote,$=e.landedMarks;const b={headers:new a.WM({"Content-Type":"application/x-www-form-urlencoded"})},f=new URLSearchParams;let S=window.localStorage.getItem("Token");return this.http.post(`${s.N.apiUrl}/save_item?user_token=${S}&username=&segment_code=${n}&saas_id=LIVEFSL&job_no=${o}&container_no=${r}&house_no=${c}&package_type=${l}&received_qty=${d}&good_damage=${u}&damage_type=${m}&damage_note=${p}&weight=${g}&volume=${h}&subjob_no=${_}&cfs_note=${w}&landed_marks=${$}`,f.toString(),b).pipe((0,i.U)(e=>{try{return e}catch(t){return e}}))}getUnloadDetails(e,t){let n=t.segment_code,o=e.selectedContainer.job_no,r=t.container_number,c=e.hblNumber;const l={headers:new a.WM({"Content-Type":"application/x-www-form-urlencoded"})},d=new URLSearchParams;let u=window.localStorage.getItem("Token");return this.http.post(`${s.N.apiUrl}/getitem_list?user_token=${u}&username=&segment_code=${n}&saas_id=LIVEFSL&job_no=${o}&container_no=${r}&house_no=${c}`,d.toString(),l).pipe((0,i.U)(e=>{try{return e}catch(t){return e}}))}deleteItem(e,t,n,o){let r=e,c=n,l=t,d=o;const u={headers:new a.WM({"Content-Type":"application/x-www-form-urlencoded"})},m=new URLSearchParams;let p=window.localStorage.getItem("Token");return this.http.post(`${s.N.apiUrl}/delete_item?user_token=${p}&username=&sl_no=${r}&segment_code=${c}&saas_id=LIVEFSL&job_no=${l}&container_no=&house_no=${d}`,m.toString(),u).pipe((0,i.U)(e=>{try{return e}catch(t){return e}}))}packType(){const e={headers:new a.WM({"Content-Type":"application/x-www-form-urlencoded"})},t=new URLSearchParams;let n=window.localStorage.getItem("Token");return this.http.post(`${s.N.apiUrl}/getpack_list?user_token=${n}&username=&saas_id=LIVEFSL&search_key=`,t.toString(),e).pipe((0,i.U)(e=>{try{return e}catch(t){return e}}))}damageType(){const e={headers:new a.WM({"Content-Type":"application/x-www-form-urlencoded"})},t=new URLSearchParams;let n=window.localStorage.getItem("Token");return this.http.post(`${s.N.apiUrl}/getdamage_list?user_token=${n}&username=&saas_id=LIVEFSL&search_key=`,t.toString(),e).pipe((0,i.U)(e=>{try{return e}catch(t){return e}}))}addUnloadEntry(e,t,n){let a=this.getLocalStorage();return a.map(a=>{a.container==e&&a.hblList.map(e=>{e.hblNumber==t&&(e.unloadEntries.push(n),e.unloaded=e.unloaded+n.receivedPiece,e.balance=e.manifestedPieces-e.unloaded)})}),this.setLocalStorage(a),(0,o.of)({}).pipe((0,r.gw)(1e3))}uploadPhoto(e,t,n,o,r){let i=window.localStorage.getItem("Token"),c=`${s.N.apiUrl}/insert_image?master_house=${t}`;const l={user_token:i,username:"",saas_id:"LIVEFSL",segment_code:n.segment_code,container_no:n.container_number,house_no:o.hblNumber,job_no:n.job_no,file_name:(new Date).getTime(),file_content:e,subjob_no:r},d={headers:new a.WM({"Content-Type":"application/json"})};return this.http.post(c,l,d)}complete(e,t){let n=t.segment_code,o=e.selectedContainer.job_no,r=t.container_number,c=e.subjob_no;const l={headers:new a.WM({"Content-Type":"application/x-www-form-urlencoded"})},d=new URLSearchParams;let u=window.localStorage.getItem("Token");return this.http.post(`${s.N.apiUrl}/complete_devanning?user_token=${u}&segment_code=${n}&saas_id=LIVEFSL&job_no=${o}&container_no=${r}&subjob_no=${c}`,d.toString(),l).pipe((0,i.U)(e=>{try{return e}catch(t){return e}}))}labelPrint(e,t,n){let o=t.fse_number,r=n.hblNumber,c=e.eta,l=t.pod_text,d=e.unload,u=e.numberOfPakages;const m={headers:new a.WM({"Content-Type":"application/x-www-form-urlencoded"})},p=new URLSearchParams;let g=window.localStorage.getItem("Token");return this.http.post(`${s.N.apiUrl}/labelprint_devanning?user_token=${g}&saas_id=LIVEFSL&fsc=${o}&hbl=${r}&eta=${c}&pod=${l}&no_of_label=${d}&pcktype=${u}`,p.toString(),m).pipe((0,i.U)(e=>{try{return e}catch(t){return e}}))}}return e.\u0275fac=function(t){return new(t||e)(c.LFG(a.eN))},e.\u0275prov=c.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()}}]);