(self.webpackChunkcfs=self.webpackChunkcfs||[]).push([[592],{5203:(e,t,a)=>{"use strict";a.d(t,{a:()=>f});var s=a(3679),n=a(3109),c=a(7716),l=a(2238),i=a(8583),o=a(1095),r=a(8295),d=a(7441),m=a(2458);function h(e,t){1&e&&c._UZ(0,"div",7)}function u(e,t){if(1&e&&(c.TgZ(0,"div"),c._uU(1),c.qZA()),2&e){const e=c.oxw();c.xp6(1),c.Oqu(e.scannedValue)}}function g(e,t){if(1&e&&(c.TgZ(0,"mat-option",8),c._uU(1),c.qZA()),2&e){const e=t.$implicit;c.Q6J("value",e.id),c.xp6(1),c.hij(" ",e.label," ")}}let f=(()=>{class e{constructor(e){this.dialogRef=e,this.cameraFC=new s.NI,this.cameras=[],this.selectCameraLabel="Loading Camera...",this.scannedValue=""}ngOnInit(){n.t2.getCameras().then(e=>{e&&e.length&&(this.selectCameraLabel="Select Camera",this.cameras=e,this.cameraFC.setValue(this.getLastCamera(),{emitEvent:!1}),this.scan(this.cameraFC.value))}).catch(e=>{}),this.cameraFC.valueChanges.subscribe(e=>{localStorage.setItem("lastUsedCameraId",e),this.scan(e),this.scannedValue=""})}getLastCamera(){let e;try{e=localStorage.getItem("lastUsedCameraId")}catch(t){}return e=e||this.cameras[0].id,e}scan(e){var t,a,s;let c=(null===(t=document.getElementById("scanner"))||void 0===t?void 0:t.offsetWidth)?(null===(a=document.getElementById("scanner"))||void 0===a?void 0:a.offsetWidth)-100:innerWidth;(null===(s=document.getElementById("scanner"))||void 0===s?void 0:s.offsetHeight)?document.getElementById("scanner"):innerHeight,this.html5QrCode=new n.t2("scanner",!0),this.html5QrCode.start(e,{fps:10,qrbox:{width:c,height:c}},(e,t)=>{this.scannedValue=e,this.dialogRef.close(this.scannedValue)},e=>{console.log(e)}).catch(e=>{})}ngOnDestroy(){this.html5QrCode.stop().then(e=>{}).catch(e=>{})}}return e.\u0275fac=function(t){return new(t||e)(c.Y36(l.so))},e.\u0275cmp=c.Xpm({type:e,selectors:[["app-barcode-scanner-popup"]],decls:10,vars:5,consts:[["id","scanner","class","w-100",4,"ngIf"],[1,"d-flex","mt-3"],["mat-raised-button","","mat-dialog-close","",1,"ml-auto"],[4,"ngIf"],[1,"w-100","mt-3"],[3,"formControl"],[3,"value",4,"ngFor","ngForOf"],["id","scanner",1,"w-100"],[3,"value"]],template:function(e,t){1&e&&(c.YNc(0,h,1,0,"div",0),c.TgZ(1,"div",1),c.TgZ(2,"button",2),c._uU(3,"Close"),c.qZA(),c.qZA(),c.YNc(4,u,2,1,"div",3),c.TgZ(5,"mat-form-field",4),c.TgZ(6,"mat-label"),c._uU(7),c.qZA(),c.TgZ(8,"mat-select",5),c.YNc(9,g,2,2,"mat-option",6),c.qZA(),c.qZA()),2&e&&(c.Q6J("ngIf",!t.scannedValue),c.xp6(4),c.Q6J("ngIf",t.scannedValue),c.xp6(3),c.Oqu(t.selectCameraLabel),c.xp6(1),c.Q6J("formControl",t.cameraFC),c.xp6(1),c.Q6J("ngForOf",t.cameras))},directives:[i.O5,o.lW,l.ZT,r.KE,r.hX,d.gD,s.JJ,s.oH,i.sg,m.ey],styles:[""]}),e})()}}]);